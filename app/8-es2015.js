(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Muja:function(t,e,n){"use strict";var s=n("EqEh");e.a=function(t,e){return Object(s.a)(t,e)}},wbm3:function(t,e,n){"use strict";n.r(e),n.d(e,"EvaluateAbsencesModule",(function(){return tt}));var s=n("PCNd"),i=n("tyNb"),r=n("1G5W"),c=n("CCnw"),o=n("CqUA"),a=n("NPit"),l=n("fhBx"),u=n("Xr/R"),b=n("fXoL"),d=n("ofXK");let f=(()=>{class t extends l.b{constructor(t,e,n,s){super(t,e,n,"/evaluate-absences"),this.lessonPresenceService=s,this.queryParamsString$.pipe(Object(r.a)(this.destroy$)).subscribe(t=>this.confirmBackLinkParams={returnparams:t})}getInitialFilter(){return{student:null,educationalEvent:null,studyClass:null}}isValidFilter(t){return Boolean(t.student||t.educationalEvent||t.studyClass)}getInitialSorting(){return{key:"StudentFullName",ascending:!0}}loadEntries(t,e,n){return this.loadingService.load(this.lessonPresenceService.getStatistics(t,e,n),l.a)}buildParamsFromFilter(t){return Object(a.a)(t)}}return t.\u0275fac=function(e){return new(e||t)(b.Xb(d.i),b.Xb(o.a),b.Xb(u.a),b.Xb(c.a))},t.\u0275prov=b.Gb({token:t,factory:t.\u0275fac}),t})();var h=n("qUtt");let p=(()=>{class t{constructor(t){this.state=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(b.Kb(f))},t.\u0275cmp=b.Eb({type:t,selectors:[["erz-evaluate-absences"]],features:[b.wb([f,{provide:h.a,useExisting:f}])],decls:1,vars:0,template:function(t,e){1&t&&b.Lb(0,"router-outlet")},directives:[i.i],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),t})();var g=n("lJxs"),m=n("IzEk"),v=n("yl8S"),y=n("KJh6"),P=n("EOpz"),O=n("mmcK"),C=n("vjgy"),x=n("4vbw"),S=n("jSy9"),j=n("sYmb");let E=(()=>{class t{constructor(t,e,n){this.studentsService=t,this.educationalEventsService=e,this.studyClassesService=n,this.filter={student:null,educationalEvent:null,studyClass:null},this.filterChange=new b.n}ngOnInit(){}show(){this.filterChange.emit(this.filter)}}return t.\u0275fac=function(e){return new(e||t)(b.Kb(O.a),b.Kb(C.a),b.Kb(x.a))},t.\u0275cmp=b.Eb({type:t,selectors:[["erz-evaluate-absences-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},decls:20,vars:18,consts:[[1,"filters","mb-2"],[1,"form-group"],[3,"typeaheadService","value","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(b.Pb(0,"div",0),b.Pb(1,"div",1),b.Pb(2,"label"),b.Ec(3),b.ec(4,"translate"),b.Ob(),b.Pb(5,"erz-typeahead",2),b.bc("valueChange",(function(t){return e.filter.student=t})),b.Ob(),b.Ob(),b.Pb(6,"div",1),b.Pb(7,"label"),b.Ec(8),b.ec(9,"translate"),b.Ob(),b.Pb(10,"erz-typeahead",2),b.bc("valueChange",(function(t){return e.filter.educationalEvent=t})),b.Ob(),b.Ob(),b.Pb(11,"div",1),b.Pb(12,"label"),b.Ec(13),b.ec(14,"translate"),b.Ob(),b.Pb(15,"erz-typeahead",2),b.bc("valueChange",(function(t){return e.filter.studyClass=t})),b.Ob(),b.Ob(),b.Pb(16,"div",3),b.Pb(17,"button",4),b.bc("click",(function(){return e.show()})),b.Ec(18),b.ec(19,"translate"),b.Ob(),b.Ob(),b.Ob()),2&t&&(b.xb(3),b.Fc(b.fc(4,10,"evaluate-absences.header.student")),b.xb(2),b.jc("typeaheadService",e.studentsService)("value",e.filter.student),b.xb(3),b.Fc(b.fc(9,12,"evaluate-absences.header.module-instance")),b.xb(2),b.jc("typeaheadService",e.educationalEventsService)("value",e.filter.educationalEvent),b.xb(3),b.Fc(b.fc(14,14,"evaluate-absences.header.study-class")),b.xb(2),b.jc("typeaheadService",e.studyClassesService)("value",e.filter.studyClass),b.xb(3),b.Gc(" ",b.fc(19,16,"evaluate-absences.header.show")," "))},directives:[S.a],pipes:[j.c],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1.5rem;border-bottom:1px solid #dee2e6}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),t})();var w=n("dlKe"),$=n("4Kj8");function k(t,e){if(1&t){const t=b.Qb();b.Pb(0,"th",13),b.bc("click",(function(){b.uc(t);const n=e.$implicit;return b.dc(5).state.toggleSorting(n.key)})),b.Pb(1,"div",14),b.Pb(2,"div",15),b.Ec(3),b.ec(4,"translate"),b.Ob(),b.Pb(5,"div",16),b.Ec(6),b.ec(7,"async"),b.Ob(),b.Ob(),b.Ob()}if(2&t){const t=e.$implicit,n=b.dc(5);b.jc("ngClass",t.label),b.xb(3),b.Gc(" ",b.fc(4,3,"evaluate-absences.list.header."+t.label)," "),b.xb(3),b.Gc(" ",b.fc(7,5,n.getSortingChar$(t))," ")}}const F=function(t){return["student",t]},I=function(t){return{returnparams:t}};function M(t,e){if(1&t&&(b.Pb(0,"a",20),b.ec(1,"async"),b.Ec(2),b.Ob()),2&t){const t=b.dc().$implicit,e=b.dc().$implicit,n=b.dc(6);b.jc("routerLink",b.nc(5,F,e.StudentRef.Id))("queryParams",b.nc(7,I,b.fc(1,3,n.profileReturnParams$))),b.xb(2),b.Gc(" ",e[t.key]," ")}}function z(t,e){if(1&t&&b.Ec(0),2&t){const t=b.dc().$implicit,e=b.dc().$implicit;b.Gc(" ",e[t.key]," ")}}function R(t,e){if(1&t&&(b.Pb(0,"td"),b.ec(1,"translate"),b.Cc(2,M,3,9,"a",18),b.Cc(3,z,1,1,"ng-template",null,19,b.Dc),b.Ob()),2&t){const t=e.$implicit,n=b.tc(4);b.yb("data-label",b.fc(1,3,"evaluate-absences.list.header."+t.label)),b.xb(2),b.jc("ngIf","StudentFullName"===t.key)("ngIfElse",n)}}function L(t,e){if(1&t&&(b.Pb(0,"tr"),b.Cc(1,R,5,5,"td",17),b.Ob()),2&t){const t=b.dc(6);b.xb(1),b.jc("ngForOf",t.columns)}}function K(t,e){if(1&t&&(b.Pb(0,"tbody"),b.Cc(1,L,2,1,"tr",17),b.Ob()),2&t){const t=b.dc(4).erzLet;b.xb(1),b.jc("ngForOf",t.entries)}}function N(t,e){1&t&&b.Lb(0,"erz-spinner",21)}function G(t,e){if(1&t){const t=b.Qb();b.Pb(0,"button",22),b.bc("click",(function(){return b.uc(t),b.dc(5).state.nextPage()})),b.Ec(1),b.ec(2,"translate"),b.Ob()}2&t&&(b.xb(1),b.Gc(" ",b.fc(2,1,"global.pagination.load-more")," "))}function X(t,e){if(1&t){const t=b.Qb();b.Pb(0,"div",7),b.Pb(1,"table",8),b.bc("scrolled",(function(){return b.uc(t),b.dc(4).onScroll()})),b.Pb(2,"thead"),b.Pb(3,"tr"),b.Cc(4,k,8,7,"th",9),b.Ob(),b.Ob(),b.Cc(5,K,2,1,"tbody",10),b.Ob(),b.Cc(6,N,1,0,"erz-spinner",11),b.Cc(7,G,3,3,"button",12),b.Ob()}if(2&t){const t=b.dc(3).erzLet,e=b.dc();b.xb(4),b.jc("ngForOf",e.columns),b.xb(1),b.jc("ngIf",t.entries&&t.entries.length>0),b.xb(1),b.jc("ngIf",t.loadingPage),b.xb(1),b.jc("ngIf",t.hasMore&&!t.loadingPage)}}function A(t,e){1&t&&(b.Pb(0,"p",23),b.Ec(1),b.ec(2,"translate"),b.Ob()),2&t&&(b.xb(1),b.Gc(" ",b.fc(2,1,"evaluate-absences.no-entries")," "))}function q(t,e){if(1&t&&(b.Nb(0),b.Cc(1,X,8,4,"div",5),b.Cc(2,A,3,3,"ng-template",null,6,b.Dc),b.Mb()),2&t){const t=b.tc(3),e=b.dc(2).erzLet;b.xb(1),b.jc("ngIf",e.entries&&e.entries.length>0||e.loadingPage)("ngIfElse",t)}}function T(t,e){1&t&&b.Lb(0,"erz-spinner")}function _(t,e){if(1&t&&(b.Nb(0),b.Cc(1,q,4,2,"ng-container",2),b.ec(2,"async"),b.Cc(3,T,1,0,"ng-template",null,4,b.Dc),b.Mb()),2&t){const t=b.tc(4),e=b.dc(2);b.xb(1),b.jc("ngIf",!b.fc(2,2,e.state.loading$))("ngIfElse",t)}}function D(t,e){1&t&&(b.Pb(0,"p",23),b.Ec(1),b.ec(2,"translate"),b.Ob()),2&t&&(b.xb(1),b.Fc(b.fc(2,1,"evaluate-absences.no-filter")))}function H(t,e){if(1&t){const t=b.Qb();b.Nb(0),b.Pb(1,"erz-evaluate-absences-header",1),b.bc("filterChange",(function(e){return b.uc(t),b.dc().state.setFilter(e)})),b.ec(2,"async"),b.Ob(),b.Cc(3,_,5,4,"ng-container",2),b.ec(4,"async"),b.Cc(5,D,3,3,"ng-template",null,3,b.Dc),b.Mb()}if(2&t){const t=b.tc(6),e=b.dc();b.xb(1),b.jc("filter",b.fc(2,3,e.filterFromParams$)),b.xb(2),b.jc("ngIf",b.fc(4,5,e.state.isFilterValid$))("ngIfElse",t)}}const J=function(t,e,n){return{entries:t,hasMore:e,loadingPage:n}};let Q=(()=>{class t{constructor(t,e,n,s){this.state=t,this.scrollPosition=e,this.route=n,this.presenceTypesService=s,this.columns=[{key:"StudentFullName",label:"student"},{key:"TotalAbsences",label:"total"},{key:"TotalAbsencesValidExcuse",label:"valid-excuse"},{key:"TotalAbsencesWithoutExcuse",label:"without-excuse"},{key:"TotalAbsencesUnconfirmed",label:"unconfirmed"},{key:"TotalIncidents",label:"incident"}],this.filterFromParams$=this.route.queryParams.pipe(Object(g.a)(V)),this.profileReturnParams$=this.state.queryParamsString$}ngOnInit(){this.filterFromParams$.pipe(Object(m.a)(1)).subscribe(t=>this.state.setFilter(t)),this.presenceTypesService.halfDayActive$.subscribe(t=>{t&&(this.columns=[...this.columns,{key:"TotalHalfDays",label:"halfday"}])})}ngAfterViewInit(){this.scrollPosition.restore()}onScroll(){this.state.nextPage()}getSortingChar$(t){return this.state.sorting$.pipe(Object(g.a)(e=>e&&t.key===e.key?e.ascending?"\u2193":"\u2191":""))}}return t.\u0275fac=function(e){return new(e||t)(b.Kb(f),b.Kb(v.a),b.Kb(i.a),b.Kb(y.a))},t.\u0275cmp=b.Eb({type:t,selectors:[["erz-evaluate-absences-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],["infiniteScroll","",1,"table","table-striped","table-fixed",3,"scrolled"],["scope","col",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","inline",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm d-block mx-auto",3,"click",4,"ngIf"],["scope","col",3,"ngClass","click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction"],[4,"ngFor","ngForOf"],["class","student",3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["noLink",""],[1,"student",3,"routerLink","queryParams"],[1,"inline"],["type","button",1,"btn","btn-secondary","btn-sm","d-block","mx-auto",3,"click"],[1,"mt-3","px-3"]],template:function(t,e){1&t&&(b.Cc(0,H,7,7,"ng-container",0),b.ec(1,"async"),b.ec(2,"async"),b.ec(3,"async")),2&t&&b.jc("erzLet",b.pc(7,J,b.fc(1,1,e.state.entries$),b.fc(2,3,e.state.hasMore$),b.fc(3,5,e.state.loadingPage$)))},directives:[P.a,E,d.m,w.a,d.l,d.k,i.g,$.a],pipes:[d.b,j.c],styles:["th[_ngcontent-%COMP%]{cursor:pointer}th.student[_ngcontent-%COMP%]{width:30%}.column-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}a.student[_ngcontent-%COMP%]{color:#33333d}"],changeDetection:0}),t})();function V(t){return{student:t.student?Number(t.student):null,educationalEvent:t.educationalEvent?Number(t.educationalEvent):null,studyClass:t.studyClass?Number(t.studyClass):null}}var B=n("ccj6"),U=n("hH5/");const W=[{path:"",component:p,children:[{path:"",component:Q,data:{restoreScrollPositionFrom:["/evaluate-absences/student/:id"]}},{path:"student/:id",children:[{path:"",component:B.a},{path:"confirm",component:U.a}]}]}];let Y=(()=>{class t{}return t.\u0275mod=b.Ib({type:t}),t.\u0275inj=b.Hb({factory:function(e){return new(e||t)},imports:[[i.h.forChild(W)],i.h]}),t})();var Z=n("0HM3");let tt=(()=>{class t{}return t.\u0275mod=b.Ib({type:t}),t.\u0275inj=b.Hb({factory:function(e){return new(e||t)},providers:[{provide:Z.a,useValue:"/evaluate-absences"}],imports:[[s.a,Y]]}),t})()},yl8S:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var s=n("tyNb"),i=n("XNiG"),r=n("LRne"),c=n("pLZG"),o=n("lJxs"),a=n("IzEk"),l=n("5+tZ"),u=n("eIep"),b=n("Y6wi"),d=n("UXun"),f=n("1G5W"),h=n("7o/Q");class p{constructor(t){this.total=t}call(t,e){return e.subscribe(new g(t,this.total))}}class g extends h.a{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}var m=n("fXoL"),v=n("ofXK");let y=(()=>{class t{constructor(t,e){this.router=t,this.viewportScroller=e,this.scrollPositions={},this.previousRoute=null,this.currentRoute=null,this.currentScrollPosition=[0,0],this.destroy$=new i.a,this.scrollPosition$=this.router.events.pipe(Object(c.a)(O),Object(o.a)(this.getScrollPosition.bind(this))),this.activationEnd$=this.router.events.pipe(Object(c.a)(P)),this.navigationEnd$=this.router.events.pipe(Object(c.a)(C)),this.route$=this.activationEnd$.pipe(Object(a.a)(1)).pipe(Object(l.a)(t=>[Object(r.a)(t),this.navigationEnd$.pipe(Object(u.a)(()=>this.activationEnd$.pipe(Object(a.a)(1))))]),Object(b.a)(),Object(o.a)(t=>t.snapshot),Object(d.a)(1)),this.scrollPosition$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>this.currentScrollPosition=t),this.route$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>{this.previousRoute=this.currentRoute,this.currentRoute=t})}ngOnDestroy(){this.destroy$.next()}restore(){if(!this.currentRoute||!this.requiresStoring(this.currentRoute))return;if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){const t=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[t]||[0,0])}const t=this.currentRoute;this.route$.pipe(t=>t.lift(new p(1)),Object(a.a)(1),Object(f.a)(this.destroy$),Object(c.a)(e=>this.shouldStoreFor(t,e))).subscribe(()=>{const e=this.getPath(t);this.scrollPositions[e]=this.currentScrollPosition})}getScrollPosition(){return this.viewportScroller.getScrollPosition()}scrollToPosition(t){this.viewportScroller.scrollToPosition(t)}getPath(t){return t?"/"+t.pathFromRoot.map(t=>t.routeConfig&&t.routeConfig.path).filter(t=>t).join("/"):"/"}requiresStoring(t){return Boolean(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}shouldStoreFor(t,e){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(e))}}return t.\u0275fac=function(e){return new(e||t)(m.Xb(s.e),m.Xb(v.t))},t.\u0275prov=m.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function P(t){return t instanceof s.b}function O(t){return t instanceof s.d}function C(t){return t instanceof s.c}}}]);