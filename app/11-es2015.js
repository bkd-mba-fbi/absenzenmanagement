(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{CZtb:function(e,t,n){"use strict";n.r(t),n.d(t,"MyAbsencesModule",(function(){return xt}));var s=n("PCNd"),c=n("tyNb"),i=n("jtHE"),r=n("itXk"),o=n("eIep"),a=n("UXun"),b=n("pLZG"),l=n("lJxs"),d=n("IzEk"),u=n("JX91"),f=n("oB13"),p=n("x+ZX"),m=n("Xr/R"),g=n("fbMX"),h=n("mmcK"),y=n("IClS"),v=n("K+0v"),O=n("eB9A"),P=n("fXoL");let C=(()=>{class e{constructor(e,t,n){var s;this.settings=e,this.storageService=t,this.studentsService=n,this.studentId$=new i.a(1),this.lessonAbsences$=this.studentId$.pipe(Object(o.a)(this.loadLessonAbsences.bind(this)),Object(a.a)(1)),this.lessonIncidents$=this.studentId$.pipe(Object(o.a)(this.loadLessonIncidents.bind(this)),Object(a.a)(1)),this.lessonPresences$=this.getLessonPresences(),this.openAbsences$=this.getAbsences(this.settings.unconfirmedAbsenceStateId),this.excusedAbsences$=this.getAbsences(this.settings.excusedAbsenceStateId),this.unexcusedAbsences$=this.getAbsences(this.settings.unexcusedAbsenceStateId),this.incidents$=this.getAbsences(null),this.openLessonAbsences$=Object(r.a)([this.openAbsences$.pipe(Object(b.a)(v.e)),this.lessonAbsences$]).pipe(Object(l.a)(Object(O.a)(this.getOpenLessonAbsences.bind(this))),Object(a.a)(1)),this.counts$=this.getCounts();const c=(null===(s=this.storageService.getPayload())||void 0===s?void 0:s.id_person)||null;c&&this.studentId$.next(c)}reset(){this.studentId$.pipe(Object(d.a)(1)).subscribe(e=>this.studentId$.next(e))}getLessonPresences(){return this.getCached(Object(r.a)([this.studentId$,this.lessonAbsences$,this.lessonIncidents$]).pipe(Object(o.a)(([e,t,n])=>this.loadTimetableEntries(e,t,n).pipe(Object(l.a)(e=>this.buildLessonPresences(t,n,e)))),Object(l.a)(y.c)))}getAbsences(e){return this.getCached(this.lessonPresences$.pipe(Object(l.a)(t=>(null==t?void 0:t.filter(t=>t.ConfirmationStateId===e))||null)))}getOpenLessonAbsences(e,t){const n=e.map(e=>e.LessonRef.Id);return t.filter(e=>n.includes(e.LessonRef.Id))}getCounts(){return Object(r.a)([this.getCount(this.openAbsences$),this.getCount(this.excusedAbsences$),this.getCount(this.unexcusedAbsences$),this.getCount(this.incidents$)]).pipe(Object(l.a)(([e,t,n,s])=>({openAbsences:e,excusedAbsences:t,unexcusedAbsences:n,incidents:s,halfDays:null})))}getCached(e){return e.pipe(Object(u.a)(null),Object(f.a)(()=>new i.a(1)),Object(p.a)())}getCount(e){return e.pipe(Object(l.a)(e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:null}))}loadLessonAbsences(e){return this.studentsService.getLessonAbsences(e)}loadLessonIncidents(e){return this.studentsService.getLessonIncidents(e)}loadTimetableEntries(e,t,n){return this.studentsService.getTimetableEntries(e,{"filter.Id":";"+[...t,...n].map(e=>e.LessonRef.Id).join(";"),fields:"Id,From,To,EventNumber,EventDesignation,EventManagerInformation"})}buildLessonPresences(e,t,n){return[...e,...t].map(e=>this.buildLessonPresence(e,n)).filter(v.e)}buildLessonPresence(e,t){const n=t.find(t=>t.Id===e.LessonRef.Id);return n?{Id:"",LessonRef:e.LessonRef,StudentRef:e.StudentRef,EventRef:{Id:0,HRef:null},TypeRef:e.TypeRef,ConfirmationStateId:"ConfirmationStateId"in e?e.ConfirmationStateId:null,EventDesignation:n.EventDesignation,HasStudyCourseConfirmationCode:!1,LessonDateTimeFrom:n.From,LessonDateTimeTo:n.To,Comment:null,Date:n.From,Type:e.Type,StudentFullName:e.StudentFullName,StudyClassNumber:"",TeacherInformation:n.EventManagerInformation,WasAbsentInPrecedingLesson:!1}:null}}return e.\u0275fac=function(t){return new(t||e)(P.Xb(m.a),P.Xb(g.a),P.Xb(h.a))},e.\u0275prov=P.Gb({token:e,factory:e.\u0275fac}),e})(),x=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences"]],features:[P.wb([C])],decls:1,vars:0,template:function(e,t){1&e&&P.Lb(0,"router-outlet")},directives:[c.i],styles:[""],changeDetection:0}),e})();var I=n("XNiG"),j=n("LRne"),S=n("5QKP"),k=n("Ug8t"),$=n("8teX"),L=n("BeL+"),T=n("tPH9"),E=n("ylTp"),w=n("9f76"),M=n("/1FC"),A=E.a?E.a.isConcatSpreadable:void 0,F=function(e){return Object(M.a)(e)||Object(w.a)(e)||!!(A&&e&&e[A])},D=function(e){return null!=e&&e.length?function e(t,n,s,c,i){var r=-1,o=t.length;for(s||(s=F),i||(i=[]);++r<o;){var a=t[r];n>0&&s(a)?n>1?e(a,n-1,s,c,i):Object(T.a)(i,a):c||(i[i.length]=a)}return i}(e,1):[]},z=n("EOpz"),_=n("1kSV"),R=n("sYmb");const G=["link"],K=function(){return["/my-absences/report"]};let N=(()=>{class e{constructor(){}onClick(){this.link.nativeElement.click()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-report-link"]],viewQuery:function(e,t){var n;1&e&&P.Jc(G,!0),2&e&&P.sc(n=P.cc())&&(t.link=n.first)},hostBindings:function(e,t){1&e&&P.bc("click",(function(e){return t.onClick(e)}))},decls:8,vars:5,consts:[[1,"m-0"],[1,"btn","btn-link","p-0",3,"routerLink"],["link",""],[1,"d-flex","align-items-center"],[1,"material-icons"]],template:function(e,t){1&e&&(P.Pb(0,"h5",0),P.Ec(1),P.ec(2,"translate"),P.Ob(),P.Pb(3,"a",1,2),P.Pb(5,"div",3),P.Pb(6,"i",4),P.Ec(7,"keyboard_arrow_right"),P.Ob(),P.Ob(),P.Ob()),2&e&&(P.xb(1),P.Gc(" ",P.fc(2,2,"my-absences.report.title"),"\n"),P.xb(2),P.jc("routerLink",P.mc(4,K)))},directives:[c.g],pipes:[R.c],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem;cursor:pointer}.btn[_ngcontent-%COMP%]{color:#33333d;text-decoration:none}"],changeDetection:0}),e})();var H=n("4vw6"),X=n("ofXK"),B=n("ZLMY");function U(e,t){1&e&&P.Lb(0,"erz-my-absences-report-link")}function Q(e,t){}function q(e,t){if(1&e&&(P.Nb(0),P.Ec(1),P.Mb()),2&e){const e=P.dc(2).erzLet;P.xb(1),P.Gc("(",e.absenceCounts.openAbsences,")")}}function Y(e,t){if(1&e){const e=P.Qb();P.Pb(0,"erz-student-profile-entry-header",11),P.bc("click",(function(){return P.uc(e),P.dc(),P.tc(2).toggle("open-absences")})),P.Ec(1),P.ec(2,"translate"),P.Cc(3,q,2,1,"ng-container",12),P.Ob()}if(2&e){const e=t.opened,n=P.dc().erzLet;P.jc("opened",e),P.xb(1),P.Gc(" ",P.fc(2,3,"shared.profile.open-absences")," "),P.xb(2),P.jc("ngIf",null!=n.absenceCounts.openAbsences)}}function J(e,t){if(1&e&&(P.Lb(0,"erz-student-profile-absences",13),P.ec(1,"translate"),P.ec(2,"async"),P.ec(3,"async")),2&e){const e=P.dc(2);P.jc("absences$",e.myAbsencesService.openAbsences$)("selectionService",e.absencesSelectionService)("defaultAbsenceSelectionMessage",P.fc(1,5,"my-absences.show.default-absence-selection-message"))("reportUrl",P.fc(2,7,e.reportUrl$))("reportAvailable",P.fc(3,9,e.reportAvailable$))}}function V(e,t){if(1&e&&(P.Nb(0),P.Ec(1),P.Mb()),2&e){const e=P.dc(2).erzLet;P.xb(1),P.Gc("(",e.absenceCounts.excusedAbsences,")")}}function W(e,t){if(1&e){const e=P.Qb();P.Pb(0,"erz-student-profile-entry-header",11),P.bc("click",(function(){return P.uc(e),P.dc(),P.tc(2).toggle("excused-absences")})),P.Ec(1),P.ec(2,"translate"),P.Cc(3,V,2,1,"ng-container",12),P.Ob()}if(2&e){const e=t.opened,n=P.dc().erzLet;P.jc("opened",e),P.xb(1),P.Gc(" ",P.fc(2,3,"shared.profile.excused-absences")," "),P.xb(2),P.jc("ngIf",null!=n.absenceCounts.excusedAbsences)}}function Z(e,t){if(1&e&&P.Lb(0,"erz-student-profile-absences",14),2&e){const e=P.dc(2);P.jc("absences$",e.myAbsencesService.excusedAbsences$)}}function ee(e,t){if(1&e&&(P.Nb(0),P.Ec(1),P.Mb()),2&e){const e=P.dc(2).erzLet;P.xb(1),P.Gc("(",e.absenceCounts.unexcusedAbsences,")")}}function te(e,t){if(1&e){const e=P.Qb();P.Pb(0,"erz-student-profile-entry-header",11),P.bc("click",(function(){return P.uc(e),P.dc(),P.tc(2).toggle("unexcused-absences")})),P.Ec(1),P.ec(2,"translate"),P.Cc(3,ee,2,1,"ng-container",12),P.Ob()}if(2&e){const e=t.opened,n=P.dc().erzLet;P.jc("opened",e),P.xb(1),P.Gc(" ",P.fc(2,3,"shared.profile.unexcused-absences")," "),P.xb(2),P.jc("ngIf",null!=n.absenceCounts.unexcusedAbsences)}}function ne(e,t){if(1&e&&P.Lb(0,"erz-student-profile-absences",15),2&e){const e=P.dc(2);P.jc("absences$",e.myAbsencesService.unexcusedAbsences$)("displayPresenceType",!1)}}function se(e,t){if(1&e&&(P.Nb(0),P.Ec(1),P.Mb()),2&e){const e=P.dc(2).erzLet;P.xb(1),P.Gc("(",e.absenceCounts.incidents,")")}}function ce(e,t){if(1&e){const e=P.Qb();P.Pb(0,"erz-student-profile-entry-header",11),P.bc("click",(function(){return P.uc(e),P.dc(),P.tc(2).toggle("incidents")})),P.Ec(1),P.ec(2,"translate"),P.Cc(3,se,2,1,"ng-container",12),P.Ob()}if(2&e){const e=t.opened,n=P.dc().erzLet;P.jc("opened",e),P.xb(1),P.Gc(" ",P.fc(2,3,"shared.profile.incidents")," "),P.xb(2),P.jc("ngIf",null!=n.absenceCounts.incidents)}}function ie(e,t){if(1&e&&P.Lb(0,"erz-student-profile-absences",14),2&e){const e=P.dc(2);P.jc("absences$",e.myAbsencesService.incidents$)}}function re(e,t){1&e&&(P.Pb(0,"div",1),P.Pb(1,"ngb-accordion",2,3),P.Pb(3,"ngb-panel",4),P.Cc(4,U,1,0,"ng-template",5),P.Cc(5,Q,0,0,"ng-template",6),P.Ob(),P.Pb(6,"ngb-panel",7),P.Cc(7,Y,4,5,"ng-template",5),P.Cc(8,J,4,11,"ng-template",6),P.Ob(),P.Pb(9,"ngb-panel",8),P.Cc(10,W,4,5,"ng-template",5),P.Cc(11,Z,1,1,"ng-template",6),P.Ob(),P.Pb(12,"ngb-panel",9),P.Cc(13,te,4,5,"ng-template",5),P.Cc(14,ne,1,2,"ng-template",6),P.Ob(),P.Pb(15,"ngb-panel",10),P.Cc(16,ce,4,5,"ng-template",5),P.Cc(17,ie,1,1,"ng-template",6),P.Ob(),P.Ob(),P.Ob())}const oe=function(e){return{absenceCounts:e}};let ae=(()=>{class e{constructor(e,t,n){this.reportsService=e,this.myAbsencesService=t,this.absencesSelectionService=n,this.reportUrl$=this.loadReportUrl(),this.reportAvailable$=this.reportsService.studentConfirmationAvailability$,this.destroy$=new I.a}ngOnInit(){this.myAbsencesService.openLessonAbsences$.pipe(Object(d.a)(1),Object(b.a)(Object(v.d)($.b))).subscribe(e=>this.reportsService.setStudentConfirmationAvailabilityRecordId(`${e[0].LessonRef.Id}_${e[0].RegistrationId}`))}ngOnDestroy(){this.destroy$.next()}loadReportUrl(){return Object(r.a)([this.absencesSelectionService.selectedWithoutPresenceType$,this.absencesSelectionService.selectedIds$]).pipe(Object(o.a)(([e,t])=>0===e.length&&t.length>0?this.getReportRecordIds(Object(L.a)(D(t.map(e=>e.lessonIds)))):Object(j.a)(null)),Object(l.a)(e=>e?this.reportsService.getStudentConfirmationUrl(e):null))}getReportRecordIds(e){return this.myAbsencesService.openLessonAbsences$.pipe(Object(l.a)(t=>t.filter(t=>e.includes(t.LessonRef.Id)).map(e=>`${e.LessonRef.Id}_${e.RegistrationId}`)))}}return e.\u0275fac=function(t){return new(t||e)(P.Kb(k.a),P.Kb(C),P.Kb(S.a))},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-show"]],decls:2,vars:5,consts:[["class","erz-container erz-container-padding-y erz-container-padding-x-responsive",4,"erzLet"],[1,"erz-container","erz-container-padding-y","erz-container-padding-x-responsive"],["ngb-accordion",""],["acc","ngbAccordion"],["id","report-absence"],["ngbPanelHeader",""],["ngbPanelContent",""],["id","open-absences"],["id","excused-absences"],["id","unexcused-absences"],["id","incidents"],[3,"opened","click"],[4,"ngIf"],[3,"absences$","selectionService","defaultAbsenceSelectionMessage","reportUrl","reportAvailable"],[3,"absences$"],[3,"absences$","displayPresenceType"]],template:function(e,t){1&e&&(P.Cc(0,re,18,0,"div",0),P.ec(1,"async")),2&e&&P.jc("erzLet",P.nc(3,oe,P.fc(1,1,t.myAbsencesService.counts$)))},directives:[z.a,_.a,_.m,_.o,_.n,N,H.a,X.m,B.a],pipes:[X.b,R.c],styles:[""],changeDetection:0}),e})();var be=n("3Pt+"),le=n("2Vo4"),de=n("wO+i"),ue=n("nYR2"),fe=n("LpL1"),pe=n("KJh6"),me=n("A6ef"),ge=n("5eHb");let he=(()=>{class e{constructor(e,t,n,s,c,i,o,a){this.fb=e,this.router=t,this.toastr=n,this.translate=s,this.presenceTypesService=c,this.updateService=i,this.storageService=o,this.settings=a,this.formGroup=this.createFormGroup(),this.saving$=new le.a(!1),this.submitted$=new le.a(!1),this.absenceTypes$=Object(r.a)([this.getConfirmationTypes(),this.getHalfDayType()]).pipe(Object(l.a)(([e,t])=>t?[...e,t]:e)),this.absenceTypeIdErrors$=Object(me.c)(Object(j.a)(this.formGroup),this.submitted$,"absenceTypeId"),this.confirmationStateId=null,this.destroy$=new I.a}ngOnInit(){this.selectedLessonIds$.pipe(Object(d.a)(1),Object(b.a)($.b)).subscribe(()=>this.navigateBack())}ngOnDestroy(){this.destroy$.next()}onSubmit(){if(this.submitted$.next(!0),this.formGroup.valid){const{absenceTypeId:e}=this.formGroup.value;this.save(e)}}cancel(){this.navigateBack()}getSelectedCount(){return this.selectedLessonIds$.pipe(Object(de.a)("length"))}getConfirmationTypes(){return this.presenceTypesService.confirmationTypes$.pipe(Object(l.a)(e=>e.filter(e=>e.IsAbsence&&e.Id!==this.settings.halfDayPresenceTypeId)))}getHalfDayType(){return Object(j.a)(null)}createFormGroup(){return this.fb.group({absenceTypeId:[null,be.p.required]})}save(e){this.saving$.next(!0),this.selectedLessonIds$.pipe(Object(d.a)(1),Object(o.a)(t=>{var n;return this.updateService.editLessonPresences(t,[Number(null===(n=this.storageService.getPayload())||void 0===n?void 0:n.id_person)],e)}),Object(ue.a)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastr.success(this.translate.instant("my-absences.confirm.save-success")),this.navigateBack()}}return e.\u0275fac=function(t){return new(t||e)(P.Kb(be.b),P.Kb(c.e),P.Kb(ge.b),P.Kb(R.d),P.Kb(pe.a),P.Kb(fe.a),P.Kb(g.a),P.Kb(m.b))},e.\u0275cmp=P.Eb({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const ye=function(e){return{count:e}};function ve(e,t){if(1&e&&(P.Pb(0,"div",10),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e){const e=t.erzLet;P.xb(1),P.Gc(" ",P.gc(2,1,1===e?"my-absences.confirm.lesson-selected":"my-absences.confirm.lessons-selected",P.nc(4,ye,e))," ")}}function Oe(e,t){if(1&e&&(P.Pb(0,"div",16),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e){const e=t.$implicit;P.xb(1),P.Gc(" ",P.gc(2,1,"global.validation-errors."+e.error,e.params)," ")}}function Pe(e,t){if(1&e&&(P.Nb(0),P.Cc(1,Oe,3,4,"div",15),P.ec(2,"async"),P.Mb()),2&e){const e=P.dc(2);P.xb(1),P.jc("ngForOf",P.fc(2,1,e.absenceTypeIdErrors$))}}const Ce=function(e){return{"border-top pt-3":e}};function xe(e,t){if(1&e&&(P.Pb(0,"div",11),P.Lb(1,"input",12),P.ec(2,"async"),P.Pb(3,"label",13),P.Ec(4),P.Ob(),P.Cc(5,Pe,3,3,"ng-container",14),P.ec(6,"async"),P.Ob()),2&e){const e=t.$implicit,s=t.index,c=P.dc();var n;P.jc("ngClass",P.nc(12,Ce,e.IsHalfDay)),P.xb(1),P.Cb("is-invalid",P.fc(2,8,c.absenceTypeIdErrors$).length>0),P.jc("id","absence-type-"+s)("value",e.Id),P.xb(2),P.jc("for","absence-type-"+s),P.xb(1),P.Gc(" ",e.Designation," "),P.xb(1),P.jc("ngIf",(null==(n=P.fc(6,10,c.absenceTypes$))?null:n.length)-1===s)}}function Ie(e,t){1&e&&(P.Pb(0,"div",17),P.Pb(1,"span",18),P.Ec(2,"Loading..."),P.Ob(),P.Ob())}let je=(()=>{class e extends he{constructor(e,t,n,s,c,i,r,o,a,b){super(e,t,n,s,c,i,r,o),this.myAbsencesService=a,this.selectionService=b,this.selectedLessonIds$=this.selectionService.selectedIds$.pipe(Object(l.a)(e=>Object(L.a)(D(e.map(e=>e.lessonIds))))),this.confirmationStateId=this.settings.unconfirmedAbsencesRefreshTime}onSaveSuccess(){this.selectionService.clear(),this.myAbsencesService.reset(),super.onSaveSuccess()}navigateBack(){this.router.navigate(["/my-absences"])}}return e.\u0275fac=function(t){return new(t||e)(P.Kb(be.b),P.Kb(c.e),P.Kb(ge.b),P.Kb(R.d),P.Kb(pe.a),P.Kb(fe.a),P.Kb(g.a),P.Kb(m.a),P.Kb(C),P.Kb(S.a))},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-confirm"]],features:[P.ub],decls:24,vars:28,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y"],["class","mb-3 pb-3 border-bottom",4,"erzLet"],[3,"formGroup","ngSubmit"],[1,"form-group","mb-3","border-bottom"],["class","form-check my-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"remark"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"mb-3","pb-3","border-bottom"],[1,"form-check","my-3",3,"ngClass"],["type","radio","formControlName","absenceTypeId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"],[4,"ngIf"],["class","invalid-feedback mt-4",4,"ngFor","ngForOf"],[1,"invalid-feedback","mt-4"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"sr-only"]],template:function(e,t){1&e&&(P.Pb(0,"div",0),P.Cc(1,ve,3,6,"div",1),P.ec(2,"async"),P.Pb(3,"form",2),P.bc("ngSubmit",(function(){return t.onSubmit()})),P.Pb(4,"div",3),P.Pb(5,"label"),P.Ec(6),P.ec(7,"translate"),P.Ob(),P.Cc(8,xe,7,14,"div",4),P.ec(9,"async"),P.Ob(),P.Pb(10,"div",5),P.Ec(11),P.ec(12,"translate"),P.Ob(),P.Pb(13,"div",6),P.Pb(14,"button",7),P.bc("click",(function(){return t.cancel()})),P.ec(15,"async"),P.Ec(16),P.ec(17,"translate"),P.Ob(),P.Pb(18,"button",8),P.ec(19,"async"),P.Ec(20),P.ec(21,"translate"),P.Cc(22,Ie,3,0,"div",9),P.ec(23,"async"),P.Ob(),P.Ob(),P.Ob(),P.Ob()),2&e&&(P.xb(1),P.jc("erzLet",P.fc(2,10,t.getSelectedCount())),P.xb(2),P.jc("formGroup",t.formGroup),P.xb(3),P.Gc("",P.fc(7,12,"my-absences.confirm.choose-presence-type"),":"),P.xb(2),P.jc("ngForOf",P.fc(9,14,t.absenceTypes$)),P.xb(3),P.Gc(" ",P.fc(12,16,"my-absences.confirm.remark")," "),P.xb(3),P.jc("disabled",P.fc(15,18,t.saving$)),P.xb(2),P.Gc(" ",P.fc(17,20,"my-absences.confirm.cancel")," "),P.xb(2),P.jc("disabled",P.fc(19,22,t.saving$)),P.xb(2),P.Gc(" ",P.fc(21,24,"my-absences.confirm.save")," "),P.xb(2),P.jc("ngIf",P.fc(23,26,t.saving$)))},directives:[z.a,be.r,be.i,be.d,X.l,X.m,X.k,be.m,be.a,be.h,be.c],pipes:[X.b,R.c],styles:[""],changeDetection:0}),e})();var Se=n("tk/3"),ke=n("sWYD"),$e=n("Xep9"),Le=n("9/EM"),Te=n("fhBx"),Ee=n("CqUA");let we=(()=>{class e extends Te.b{constructor(e,t,n,s,c){super(e,t,n,"/my-absences/report"),this.studentsService=s,this.storageService=c}getInitialFilter(){return{dateFrom:null,dateTo:null}}isValidFilter(e){return Boolean(e.dateFrom||e.dateTo)}loadEntries(e,t,n){const s=this.buildRequestParamsFromFilter(e).set("sort","From.asc").set("fields","Id,From,To,EventNumber,EventDesignation,EventManagerInformation");return this.loadingService.load(this.loadTimetableEntries(s).pipe(Object(o.a)(e=>Object(r.a)([Object(j.a)(e),this.loadLessonAbsences(e),this.loadLessonDispensations(e)])),Object(l.a)(([e,t,n])=>this.buildLessonPresences(e,t,n)),Object(l.a)(e=>({offset:0,total:e.length,entries:e}))),Te.a)}buildParamsFromFilter(e){const{dateFrom:t,dateTo:n}=e,s={};return t&&(s.dateFrom=Object(ke.a)(t,"yyyy-MM-dd")),n&&(s.dateTo=Object(ke.a)(n,"yyyy-MM-dd")),s}buildRequestParamsFromFilter(e){let t=new Se.f;return e.dateFrom&&(t=t.set("filter.From",">"+Object(ke.a)(Object($e.a)(e.dateFrom,1),"yyyy-MM-dd"))),e.dateTo&&(t=t.set("filter.To","<"+Object(ke.a)(Object(Le.a)(e.dateTo,1),"yyyy-MM-dd"))),t}get studentId(){var e;const t=null===(e=this.storageService.getPayload())||void 0===e?void 0:e.id_person;if(null==t)throw new Error("No student id available");return t}loadTimetableEntries(e){return this.studentsService.getTimetableEntries(this.studentId,e)}loadLessonAbsences(e){return e.length>0?this.studentsService.getLessonAbsences(this.studentId,{"filter.Id":";"+e.map(e=>e.Id).join(";")}):Object(j.a)([])}loadLessonDispensations(e){return e.length>0?this.studentsService.getLessonDispensations(this.studentId,{"filter.Id":";"+e.map(e=>e.Id).join(";")}):Object(j.a)([])}buildLessonPresences(e,t,n){return e.map(e=>this.buildLessonPresence(e,t,n))}buildLessonPresence(e,t,n){var s,c,i;const r=t.find(t=>t.LessonRef.Id===e.Id),o=n.find(t=>t.LessonRef.Id===e.Id),a=this.buildLessonPresenceTypeRef(r,o);return{Id:"",LessonRef:{Id:e.Id,HRef:null},StudentRef:(null===(s=r||o)||void 0===s?void 0:s.StudentRef)||{Id:this.studentId,HRef:null},EventRef:{Id:0,HRef:null},TypeRef:a,ConfirmationStateId:(null==r?void 0:r.ConfirmationStateId)||o&&this.settings.excusedAbsenceStateId||null,EventDesignation:e.EventDesignation||"",HasStudyCourseConfirmationCode:!1,LessonDateTimeFrom:e.From||new Date,LessonDateTimeTo:e.To||new Date,Comment:null,Date:e.From||new Date,Type:(null===(c=r||o)||void 0===c?void 0:c.Type)||null,StudentFullName:(null===(i=r||o)||void 0===i?void 0:i.StudentFullName)||"",StudyClassNumber:"",TeacherInformation:e.EventManagerInformation,WasAbsentInPrecedingLesson:!1}}buildLessonPresenceTypeRef(e,t){return e?Object.assign({},e.TypeRef):t?Object.assign({},t.TypeRef):{Id:null,HRef:null}}}return e.\u0275fac=function(t){return new(t||e)(P.Xb(X.i),P.Xb(Ee.a),P.Xb(m.a),P.Xb(h.a),P.Xb(g.a))},e.\u0275prov=P.Gb({token:e,factory:e.\u0275fac}),e})();var Me=n("ulei");let Ae=(()=>{class e extends Me.a{constructor(){super(...arguments),this.selectedIds$=this.selection$.pipe(Object(l.a)(y.a))}}return e.\u0275fac=function(t){return Fe(t||e)},e.\u0275prov=P.Gb({token:e,factory:e.\u0275fac}),e})();const Fe=P.Rb(Ae);let De=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-report"]],features:[P.wb([we,Ae])],decls:1,vars:0,template:function(e,t){1&e&&P.Lb(0,"router-outlet")},directives:[c.i],styles:[""],changeDetection:0}),e})();var ze=n("1G5W"),_e=n("KCaQ"),Re=n("vlqf"),Ge=n("RYjX"),Ke=n("yl8S"),Ne=n("M34a"),He=n("YDIV"),Xe=n("DKSB");const Be=function(){return["/my-absences"]};let Ue=(()=>{class e{constructor(){this.filter={dateFrom:null,dateTo:null},this.filterChange=new P.n,this.minDate={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()}}ngOnInit(){}updateDateFrom(e){this.filter.dateFrom=e,e&&(this.filter.dateTo=e)}show(){this.filterChange.emit({dateFrom:Qe(this.filter.dateFrom),dateTo:Qe(this.filter.dateTo)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-report-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},features:[P.wb([{provide:_.c,useClass:_.d},{provide:_.e,useClass:He.a}])],decls:22,vars:18,consts:[[1,"backlink"],[1,"btn","btn-link","py-2","text-body",3,"routerLink"],[1,"material-icons","d-block"],[1,"filters"],[1,"form-group"],[3,"minDate","value","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(P.Pb(0,"div",0),P.Pb(1,"a",1),P.Pb(2,"i",2),P.Ec(3,"navigate_before"),P.Ob(),P.Ob(),P.Pb(4,"div"),P.Ec(5),P.ec(6,"translate"),P.Ob(),P.Ob(),P.Pb(7,"div",3),P.Pb(8,"div",4),P.Pb(9,"label"),P.Ec(10),P.ec(11,"translate"),P.Ob(),P.Pb(12,"erz-date-select",5),P.bc("valueChange",(function(e){return t.updateDateFrom(e)})),P.Ob(),P.Ob(),P.Pb(13,"div",4),P.Pb(14,"label"),P.Ec(15),P.ec(16,"translate"),P.Ob(),P.Pb(17,"erz-date-select",5),P.bc("valueChange",(function(e){return t.filter.dateTo=e})),P.Ob(),P.Ob(),P.Pb(18,"div",6),P.Pb(19,"button",7),P.bc("click",(function(){return t.show()})),P.Ec(20),P.ec(21,"translate"),P.Ob(),P.Ob(),P.Ob()),2&e&&(P.xb(1),P.jc("routerLink",P.mc(17,Be)),P.xb(4),P.Fc(P.fc(6,9,"my-absences.report.title")),P.xb(5),P.Fc(P.fc(11,11,"my-absences.report.header.date-from")),P.xb(2),P.jc("minDate",t.minDate)("value",t.filter.dateFrom),P.xb(3),P.Fc(P.fc(16,13,"my-absences.report.header.date-to")),P.xb(2),P.jc("minDate",t.minDate)("value",t.filter.dateTo),P.xb(3),P.Gc(" ",P.fc(21,15,"my-absences.report.header.show")," "))},directives:[c.g,Xe.a],pipes:[R.c],styles:["[_nghost-%COMP%]{display:block;padding:1.5rem;border-bottom:1px solid #dee2e6}.backlink[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1.5rem}.backlink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:-1.5rem}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),e})();function Qe(e){return e?Object(Ne.a)(e):null}var qe=n("4Kj8"),Ye=n("73sZ");function Je(e,t){if(1&e){const e=P.Qb();P.Pb(0,"div",12),P.Pb(1,"input",13,29),P.bc("change",(function(){P.uc(e);const t=P.dc(2).$implicit;return P.dc(6).selectionService.toggle(t)})),P.ec(3,"async"),P.Ob(),P.Ob()}if(2&e){const e=P.dc(2).$implicit,t=P.dc(6);P.xb(1),P.jc("checked",P.fc(3,1,t.selectionService.isSelected$(e)))}}function Ve(e,t){if(1&e&&(P.Pb(0,"div"),P.Pb(1,"i",17),P.Ec(2),P.Ob(),P.Ob()),2&e){const e=P.dc().erzLet;P.Ab("checkbox presence-category ",e.category,""),P.xb(2),P.Fc(e.icon)}}function We(e,t){if(1&e&&(P.Nb(0),P.Cc(1,Je,4,3,"div",27),P.Cc(2,Ve,3,4,"ng-template",null,28,P.Dc),P.Mb()),2&e){const e=t.erzLet,n=P.tc(3);P.xb(1),P.jc("ngIf",!e)("ngIfElse",n)}}function Ze(e,t){if(1&e&&(P.Nb(0),P.Ec(1),P.Mb()),2&e){const e=P.dc().$implicit;P.xb(1),P.Gc(", ",e.StudyClassNumber,"")}}function et(e,t){if(1&e&&(P.Pb(0,"div",31),P.Ec(1),P.Ob()),2&e){const e=P.dc().erzLet;P.xb(1),P.Gc(" ",e," ")}}function tt(e,t){if(1&e&&(P.Nb(0),P.Cc(1,et,2,1,"div",30),P.Mb()),2&e){const e=t.erzLet;P.xb(1),P.jc("ngIf",e)}}function nt(e,t){if(1&e){const e=P.Qb();P.Pb(0,"div",19,20),P.bc("click",(function(t){P.uc(e);const n=P.tc(1);return P.dc(6).onRowClick(t,n)})),P.Cc(2,We,4,2,"ng-container",0),P.ec(3,"async"),P.Pb(4,"div",21),P.Ec(5),P.Cc(6,Ze,2,1,"ng-container",8),P.Ob(),P.Pb(7,"div",22),P.Ec(8),P.ec(9,"date"),P.ec(10,"date"),P.Ob(),P.Pb(11,"div",23),P.Ec(12),P.Ob(),P.Cc(13,tt,2,1,"ng-container",0),P.ec(14,"async"),P.Pb(15,"div",24),P.Ec(16),P.ec(17,"date"),P.Ob(),P.Pb(18,"div",25),P.Ec(19),P.ec(20,"erzDaysDifference"),P.Ob(),P.Pb(21,"div",26),P.Ec(22),P.ec(23,"date"),P.ec(24,"erzDaysDifference"),P.Ob(),P.Ob()}if(2&e){const e=t.$implicit,n=P.dc(6);P.xb(2),P.jc("erzLet",P.fc(3,11,n.getPresenceCategory(e))),P.xb(3),P.Gc(" ",e.EventDesignation,""),P.xb(1),P.jc("ngIf",e.StudyClassNumber),P.xb(2),P.Hc(" ",P.gc(9,13,e.LessonDateTimeFrom,"HH:mm"),"\u2013",P.gc(10,16,e.LessonDateTimeTo,"HH:mm")," "),P.xb(4),P.Gc(" ",e.TeacherInformation," "),P.xb(1),P.jc("erzLet",P.fc(14,19,n.getPresenceTypeDesignation(e))),P.xb(3),P.Gc(" ",P.gc(17,21,e.LessonDateTimeFrom,"dd.MM.yyyy")," "),P.xb(3),P.Gc(" ",P.fc(20,24,e.LessonDateTimeFrom)," "),P.xb(3),P.Hc(" ",P.gc(23,26,e.LessonDateTimeFrom,"dd.MM.yyyy"),", ",P.fc(24,29,e.LessonDateTimeFrom)," ")}}function st(e,t){if(1&e){const e=P.Qb();P.Pb(0,"div"),P.Pb(1,"div",10,11),P.bc("click",(function(t){P.uc(e);const n=P.tc(2);return P.dc(5).onRowClick(t,n)})),P.Pb(3,"div",12),P.Pb(4,"input",13),P.bc("change",(function(t){return P.uc(e),P.dc(5).toggleAll(t.target.checked)})),P.ec(5,"async"),P.Ob(),P.Ob(),P.Pb(6,"div",14),P.Ec(7),P.ec(8,"translate"),P.Ob(),P.Pb(9,"div",15),P.Pb(10,"a",16),P.ec(11,"async"),P.Pb(12,"i",17),P.Ec(13,"edit"),P.Ob(),P.Ob(),P.Ob(),P.Ob(),P.Cc(14,nt,25,31,"div",18),P.Ob()}if(2&e){const e=P.dc(4).erzLet,t=P.dc();P.xb(4),P.jc("checked",P.fc(5,5,t.allSelected$)),P.xb(3),P.Gc(" ",P.fc(8,7,"my-absences.report.list.all")," "),P.xb(3),P.Cb("disabled",0===P.fc(11,9,t.selectionService.selection$).length),P.xb(4),P.jc("ngForOf",e.entries)}}function ct(e,t){1&e&&P.Lb(0,"erz-spinner",32)}function it(e,t){if(1&e&&(P.Pb(0,"div",7),P.Cc(1,st,15,11,"div",8),P.Cc(2,ct,1,0,"erz-spinner",9),P.Ob()),2&e){const e=P.dc(3).erzLet;P.xb(1),P.jc("ngIf",e.entries&&e.entries.length>0),P.xb(1),P.jc("ngIf",e.loadingPage)}}function rt(e,t){1&e&&(P.Pb(0,"p",33),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e&&(P.xb(1),P.Gc(" ",P.fc(2,1,"my-absences.report.no-entries")," "))}function ot(e,t){if(1&e&&(P.Nb(0),P.Cc(1,it,3,2,"div",5),P.Cc(2,rt,3,3,"ng-template",null,6,P.Dc),P.Mb()),2&e){const e=P.tc(3),t=P.dc(2).erzLet;P.xb(1),P.jc("ngIf",t.entries&&t.entries.length>0||t.loadingPage)("ngIfElse",e)}}function at(e,t){1&e&&P.Lb(0,"erz-spinner")}function bt(e,t){if(1&e&&(P.Nb(0),P.Cc(1,ot,4,2,"ng-container",2),P.ec(2,"async"),P.Cc(3,at,1,0,"ng-template",null,4,P.Dc),P.Mb()),2&e){const e=P.tc(4),t=P.dc(2);P.xb(1),P.jc("ngIf",!P.fc(2,2,t.state.loading$))("ngIfElse",e)}}function lt(e,t){1&e&&(P.Pb(0,"p",33),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e&&(P.xb(1),P.Fc(P.fc(2,1,"my-absences.report.no-filter")))}function dt(e,t){if(1&e){const e=P.Qb();P.Nb(0),P.Pb(1,"erz-my-absences-report-header",1),P.bc("filterChange",(function(t){return P.uc(e),P.dc().state.setFilter(t)})),P.ec(2,"async"),P.Ob(),P.Cc(3,bt,5,4,"ng-container",2),P.ec(4,"async"),P.Cc(5,lt,3,3,"ng-template",null,3,P.Dc),P.Mb()}if(2&e){const e=P.tc(6),t=P.dc();P.xb(1),P.jc("filter",P.fc(2,3,t.filterFromParams$)),P.xb(2),P.jc("ngIf",P.fc(4,5,t.state.isFilterValid$))("ngIfElse",e)}}const ut=function(e,t,n){return{selection:e,entries:t,loadingPage:n}};function ft(e){return{dateFrom:e.dateFrom?Object(_e.c)(e.dateFrom):null,dateTo:e.dateTo?Object(_e.c)(e.dateTo):null}}const pt=function(e){return{count:e}};function mt(e,t){if(1&e&&(P.Pb(0,"div",10),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e){const e=t.erzLet;P.xb(1),P.Gc(" ",P.gc(2,1,1===e?"my-absences.confirm.lesson-selected":"my-absences.confirm.lessons-selected",P.nc(4,pt,e))," ")}}function gt(e,t){if(1&e&&(P.Pb(0,"div",16),P.Ec(1),P.ec(2,"translate"),P.Ob()),2&e){const e=t.$implicit;P.xb(1),P.Gc(" ",P.gc(2,1,"global.validation-errors."+e.error,e.params)," ")}}function ht(e,t){if(1&e&&(P.Nb(0),P.Cc(1,gt,3,4,"div",15),P.ec(2,"async"),P.Mb()),2&e){const e=P.dc(2);P.xb(1),P.jc("ngForOf",P.fc(2,1,e.absenceTypeIdErrors$))}}const yt=function(e){return{"border-top pt-3":e}};function vt(e,t){if(1&e&&(P.Pb(0,"div",11),P.Lb(1,"input",12),P.ec(2,"async"),P.Pb(3,"label",13),P.Ec(4),P.Ob(),P.Cc(5,ht,3,3,"ng-container",14),P.ec(6,"async"),P.Ob()),2&e){const e=t.$implicit,s=t.index,c=P.dc();var n;P.jc("ngClass",P.nc(12,yt,e.IsHalfDay)),P.xb(1),P.Cb("is-invalid",P.fc(2,8,c.absenceTypeIdErrors$).length>0),P.jc("id","absence-type-"+s)("value",e.Id),P.xb(2),P.jc("for","absence-type-"+s),P.xb(1),P.Gc(" ",e.Designation," "),P.xb(1),P.jc("ngIf",(null==(n=P.fc(6,10,c.absenceTypes$))?null:n.length)-1===s)}}function Ot(e,t){1&e&&(P.Pb(0,"div",17),P.Pb(1,"span",18),P.Ec(2,"Loading..."),P.Ob(),P.Ob())}const Pt=[{path:"",component:x,children:[{path:"",component:ae},{path:"confirm",component:je},{path:"report",component:De,children:[{path:"",component:(()=>{class e{constructor(e,t,n,s,c,i){this.state=e,this.selectionService=t,this.route=n,this.scrollPosition=s,this.presenceTypesService=c,this.settings=i,this.filterFromParams$=this.route.queryParams.pipe(Object(l.a)(ft)),this.allSelected$=Object(r.a)([this.selectionService.selection$,this.state.entries$.pipe(Object(o.a)(e=>Object(r.a)(e.map(e=>this.getPresenceType(e)))))]).pipe(Object(l.a)(([e,t])=>e.length>0&&e.length===t.filter(Object(v.d)(Re.c)).length)),this.destroy$=new I.a}ngOnInit(){this.filterFromParams$.pipe(Object(d.a)(1)).subscribe(e=>this.state.setFilter(e)),this.state.validFilter$.pipe(Object(ze.a)(this.destroy$)).subscribe(()=>this.selectionService.clear())}ngAfterViewInit(){this.scrollPosition.restore()}ngOnDestroy(){this.destroy$.next()}getPresenceCategory(e){return this.getPresenceType(e).pipe(Object(l.a)(t=>Object(Re.c)(t)?e.ConfirmationStateId===this.settings.checkableAbsenceStateId?{category:Ge.a.Unapproved,icon:Object(Ge.c)(Ge.a.Unapproved)}:{category:Ge.a.Absent,icon:Object(Ge.c)(Ge.a.Absent)}:null))}getPresenceTypeDesignation(e){return this.presenceTypesService.displayedTypes$.pipe(Object(l.a)(t=>{var n;return e.TypeRef.Id&&(null===(n=t.find(t=>t.Id===e.TypeRef.Id))||void 0===n?void 0:n.Designation)||null}))}toggleAll(e){Object(r.a)([this.state.entries$.pipe(Object(d.a)(1)),this.presenceTypesService.presenceTypes$.pipe(Object(d.a)(1))]).subscribe(([t,n])=>{const s=n.filter(e=>Object(Re.c)(e)).map(e=>e.Id);this.selectionService.clear(e?t.filter(e=>null==e.TypeRef.Id||!s.includes(e.TypeRef.Id)):null)})}onRowClick(e,t){const n=t.querySelector('input[type="checkbox"]');n&&e.target!==n&&!Boolean(e.target.closest(".buttons"))&&n.click()}getPresenceType(e){return this.presenceTypesService.presenceTypes$.pipe(Object(l.a)(t=>e.TypeRef.Id&&t.find(t=>t.Id===e.TypeRef.Id)||null))}}return e.\u0275fac=function(t){return new(t||e)(P.Kb(we),P.Kb(Ae),P.Kb(c.a),P.Kb(Ke.a),P.Kb(pe.a),P.Kb(m.a))},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-report-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],[4,"ngIf"],["class","inline",4,"ngIf"],[1,"entries-all",3,"click"],["all",""],[1,"checkbox"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"all"],[1,"buttons"],["routerLink","confirm",1,"edit","btn","btn-primary","mr-2"],[1,"material-icons"],["class","entry",3,"click",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["row",""],[1,"lesson-class"],[1,"time","pr-2"],[1,"teacher"],[1,"date"],[1,"days-ago"],[1,"date-days-ago"],["class","checkbox",4,"ngIf","ngIfElse"],["categoryIcon",""],["checkbox",""],["class","presence-type",4,"ngIf"],[1,"presence-type"],[1,"inline"],[1,"mt-3","px-3"]],template:function(e,t){1&e&&(P.Cc(0,dt,7,7,"ng-container",0),P.ec(1,"async"),P.ec(2,"async"),P.ec(3,"async")),2&e&&P.jc("erzLet",P.pc(7,ut,P.fc(1,1,t.selectionService.selection$),P.fc(2,3,t.state.entries$),P.fc(3,5,t.state.loadingPage$)))},directives:[z.a,Ue,X.m,c.g,X.l,qe.a],pipes:[X.b,R.c,X.e,Ye.a],styles:['.entries-all[_ngcontent-%COMP%]{padding:0 0 .75rem 1.5rem;border-bottom:1px solid #e9ecef;display:-ms-grid;display:grid;grid-template-areas:"checkbox all buttons";-ms-grid-columns:-webkit-min-content 1fr -webkit-min-content;-ms-grid-columns:min-content 1fr min-content;grid-template-columns:-webkit-min-content 1fr -webkit-min-content;grid-template-columns:min-content 1fr min-content}.entries-all[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{-ms-grid-row-align:center;align-self:center}.entry[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e9ecef;display:-ms-grid;display:grid;grid-template-areas:"checkbox lesson-class time teacher" "checkbox presence-type date days-ago";-ms-grid-columns:-webkit-min-content 2fr 1fr 2fr;-ms-grid-columns:min-content 2fr 1fr 2fr;grid-template-columns:-webkit-min-content 2fr 1fr 2fr;grid-template-columns:min-content 2fr 1fr 2fr}.entry[_ngcontent-%COMP%]:first-child{padding-top:0}.entries-all[_ngcontent-%COMP%] + .entry[_ngcontent-%COMP%]{padding-top:1.5rem}.presence-category.absent[_ngcontent-%COMP%]{color:#dc3545}.presence-category.unapproved[_ngcontent-%COMP%]{color:#ffa814}.checkbox[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-column:1;grid-area:checkbox;margin:0;padding:.6rem .75rem 0 0}.entry[_ngcontent-%COMP%] > .checkbox[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-row-span:2;-ms-grid-column:1}.presence-category[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{display:block;font-size:16px}.entries-all[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{padding-top:.2rem}.checkbox[_ngcontent-%COMP%]   input.form-check-input[_ngcontent-%COMP%]{position:static!important;margin:0!important;display:block}.all[_ngcontent-%COMP%]{-ms-grid-column:2;grid-area:all}.all[_ngcontent-%COMP%], .buttons[_ngcontent-%COMP%]{-ms-grid-row:1}.buttons[_ngcontent-%COMP%]{-ms-grid-column:3;grid-area:buttons;display:flex}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{line-height:1;font-size:2.2rem}.lesson-class[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-column:2;grid-area:lesson-class;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.time[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-column:3;grid-area:time}.teacher[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-column:4;grid-area:teacher}.presence-type[_ngcontent-%COMP%]{-ms-grid-row:2;-ms-grid-column:2;color:#adb5bd;grid-area:presence-type}.date[_ngcontent-%COMP%]{-ms-grid-row:2;-ms-grid-column:3;grid-area:date}.days-ago[_ngcontent-%COMP%]{-ms-grid-row:2;-ms-grid-column:4;color:#adb5bd;grid-area:days-ago}.date-days-ago[_ngcontent-%COMP%]{grid-area:date-days-ago;display:none}@media (max-width:750px){.entry[_ngcontent-%COMP%]{grid-template-areas:"checkbox lesson-class" "checkbox teacher" "checkbox date-days-ago" "checkbox time" "checkbox presence-type";-ms-grid-columns:-webkit-min-content 1fr;-ms-grid-columns:min-content 1fr;grid-template-columns:-webkit-min-content 1fr;grid-template-columns:min-content 1fr}.date-days-ago[_ngcontent-%COMP%]{display:block}.date[_ngcontent-%COMP%], .days-ago[_ngcontent-%COMP%]{display:none}.entry[_ngcontent-%COMP%] > .checkbox[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-row-span:5;-ms-grid-column:1}.lesson-class[_ngcontent-%COMP%]{-ms-grid-row:1;-ms-grid-column:2}.time[_ngcontent-%COMP%]{-ms-grid-row:4}.teacher[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{-ms-grid-column:2}.teacher[_ngcontent-%COMP%]{-ms-grid-row:2}.presence-type[_ngcontent-%COMP%]{-ms-grid-row:5;-ms-grid-column:2}.date-days-ago[_ngcontent-%COMP%]{-ms-grid-row:3;-ms-grid-column:2}}'],changeDetection:0}),e})(),data:{restoreScrollPositionFrom:["/my-absences/report/confirm"]}},{path:"confirm",component:(()=>{class e extends he{constructor(e,t,n,s,c,i,r,o,a,b){super(e,t,n,s,c,i,r,o),this.state=a,this.selectionService=b,this.selectedLessonIds$=this.selectionService.selectedIds$.pipe(Object(l.a)(e=>Object(L.a)(D(e.map(e=>e.lessonIds))))),this.confirmationStateId=this.settings.checkableAbsenceStateId}getHalfDayType(){return this.presenceTypesService.getPresenceType(this.settings.halfDayPresenceTypeId).pipe(Object(l.a)(e=>e.Active?e:null))}onSaveSuccess(){this.selectionService.clear(),this.state.resetEntries(),super.onSaveSuccess()}navigateBack(){this.state.queryParams$.pipe(Object(d.a)(1)).subscribe(e=>{this.router.navigate(["/my-absences/report"],{queryParams:e})})}}return e.\u0275fac=function(t){return new(t||e)(P.Kb(be.b),P.Kb(c.e),P.Kb(ge.b),P.Kb(R.d),P.Kb(pe.a),P.Kb(fe.a),P.Kb(g.a),P.Kb(m.a),P.Kb(we),P.Kb(Ae))},e.\u0275cmp=P.Eb({type:e,selectors:[["erz-my-absences-confirm"]],features:[P.ub],decls:24,vars:28,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y"],["class","mb-3 pb-3 border-bottom",4,"erzLet"],[3,"formGroup","ngSubmit"],[1,"form-group","mb-3","border-bottom"],["class","form-check my-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"remark"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"mb-3","pb-3","border-bottom"],[1,"form-check","my-3",3,"ngClass"],["type","radio","formControlName","absenceTypeId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"],[4,"ngIf"],["class","invalid-feedback mt-4",4,"ngFor","ngForOf"],[1,"invalid-feedback","mt-4"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"sr-only"]],template:function(e,t){1&e&&(P.Pb(0,"div",0),P.Cc(1,mt,3,6,"div",1),P.ec(2,"async"),P.Pb(3,"form",2),P.bc("ngSubmit",(function(){return t.onSubmit()})),P.Pb(4,"div",3),P.Pb(5,"label"),P.Ec(6),P.ec(7,"translate"),P.Ob(),P.Cc(8,vt,7,14,"div",4),P.ec(9,"async"),P.Ob(),P.Pb(10,"div",5),P.Ec(11),P.ec(12,"translate"),P.Ob(),P.Pb(13,"div",6),P.Pb(14,"button",7),P.bc("click",(function(){return t.cancel()})),P.ec(15,"async"),P.Ec(16),P.ec(17,"translate"),P.Ob(),P.Pb(18,"button",8),P.ec(19,"async"),P.Ec(20),P.ec(21,"translate"),P.Cc(22,Ot,3,0,"div",9),P.ec(23,"async"),P.Ob(),P.Ob(),P.Ob(),P.Ob()),2&e&&(P.xb(1),P.jc("erzLet",P.fc(2,10,t.getSelectedCount())),P.xb(2),P.jc("formGroup",t.formGroup),P.xb(3),P.Gc("",P.fc(7,12,"my-absences.confirm.choose-presence-type"),":"),P.xb(2),P.jc("ngForOf",P.fc(9,14,t.absenceTypes$)),P.xb(3),P.Gc(" ",P.fc(12,16,"my-absences.confirm.remark")," "),P.xb(3),P.jc("disabled",P.fc(15,18,t.saving$)),P.xb(2),P.Gc(" ",P.fc(17,20,"my-absences.confirm.cancel")," "),P.xb(2),P.jc("disabled",P.fc(19,22,t.saving$)),P.xb(2),P.Gc(" ",P.fc(21,24,"my-absences.confirm.save")," "),P.xb(2),P.jc("ngIf",P.fc(23,26,t.saving$)))},directives:[z.a,be.r,be.i,be.d,X.l,X.m,X.k,be.m,be.a,be.h,be.c],pipes:[X.b,R.c],styles:[""],changeDetection:0}),e})()}]}]}];let Ct=(()=>{class e{}return e.\u0275mod=P.Ib({type:e}),e.\u0275inj=P.Hb({factory:function(t){return new(t||e)},imports:[[c.h.forChild(Pt)],c.h]}),e})(),xt=(()=>{class e{}return e.\u0275mod=P.Ib({type:e}),e.\u0275inj=P.Hb({factory:function(t){return new(t||e)},imports:[[s.a,Ct]]}),e})()}}]);