<erz-avatar
  *ngIf="!isListViewMode"
  [studentId]="studentId$ | async"
  [link]="['/presence-control/detail', entry.lessonPresence.StudentRef.Id]"
  class="mr-3 large"
></erz-avatar>
<div class="content">
  <button
    (click)="updatePresenceType(blockLessonDialog, entry)"
    class="presence-category-button btn btn-link"
  >
    <div class="presence-category">
      <span
        *ngIf="
          entry.presenceType?.IsDispensation === 1 ||
          entry.presenceType?.IsHalfDay === 1
        "
        class="presence-category-designation"
        >{{ entry.presenceType?.Designation }}</span
      >
      <i class="material-icons">{{ presenceCategoryIcon }}</i>
    </div>
  </button>
  <a
    [routerLink]="[
      '/presence-control/detail',
      entry.lessonPresence.StudentRef.Id
    ]"
    class="student-name"
    >{{ entry.lessonPresence.StudentFullName }}</a
  >
  <a
    *ngIf="
      entry.presenceCategory === 'absent' ||
      entry.presenceCategory === 'late' ||
      (entry.presenceCategory === 'present' &&
        entry.presenceType?.IsComment === 1)
    "
    class="comment mt-3"
    [routerLink]="[
      '/presence-control/comment',
      entry.lessonPresence.StudentRef.Id,
      entry.lessonPresence.LessonRef.Id
    ]"
  >
    <i class="material-icons">notes</i>
    <span>{{
      entry.lessonPresence.PresenceComment ||
        ('presence-control.entry.comment' | translate)
    }}</span>
  </a>
</div>

<ng-template #blockLessonDialog let-modal>
  <div class="modal-body">
    <p>
      {{ 'presence-control.dialog.text' | translate }}
    </p>
    <form>
      <div
        *ngFor="let lessonPresence of entry.blockLessonPresences; let i = index"
        class="form-group form-check"
      >
        <input
          type="checkbox"
          class="form-check-input"
          id="lesson-presence-{{ i }}"
          [checked]="selectionService.isSelected$(lessonPresence) | async"
          (change)="selectionService.toggle(lessonPresence)"
          [disabled]="
            lessonPresence.LessonRef.Id === entry.lessonPresence.LessonRef.Id
          "
        />
        <label class="form-check-label" for="lesson-presence-{{ i }}">
          {{ lessonPresence.LessonDateTimeFrom | date: 'HH:mm' }}â€“{{
            lessonPresence.LessonDateTimeTo | date: 'HH:mm'
          }}</label
        >
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-secondary"
      (click)="modal.close('cancel')"
    >
      {{ 'presence-control.dialog.cancel' | translate }}
    </button>
    <button type="button" class="btn btn-primary" (click)="modal.close('save')">
      {{ 'presence-control.dialog.save' | translate }}
    </button>
  </div>
</ng-template>
